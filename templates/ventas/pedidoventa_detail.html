{% extends 'base.html' %}
{% block title %}Detalle Venta{% endblock %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h3 class="fw-semibold mb-1">Venta {{ object.numero }}</h3>
    <p class="text-muted mb-0">Fecha {{ object.fecha }} Â· Cliente {{ object.cliente }}</p>
  </div>
  <div class="d-flex gap-2">
    {% if object.estado == 'pendiente' %}
      <a class="btn btn-outline-secondary" href="/ventas/pedidos/{{ object.id }}/editar/">Editar</a>
      <form method="post" action="/ventas/pedidos/{{ object.id }}/completar/">
        {% csrf_token %}
        <button class="btn btn-success" type="submit">Completar venta</button>
      </form>
    {% endif %}
    <a class="btn btn-secondary" href="/ventas/pedidos/">Volver</a>
  </div>
</div>
<div class="card mb-3">
  <div class="card-body d-flex align-items-center gap-3">
    <div>
      <p class="mb-0 text-muted">Estado</p>
      <h6 class="mb-0"><span class="badge text-bg-light border">{{ object.estado }}</span></h6>
    </div>
    <div>
      <p class="mb-0 text-muted">Total</p>
      <h4 class="mb-0">${{ object.total }}</h4>
    </div>
  </div>
</div>
<div class="card">
  <div class="table-responsive">
    <table class="table table-sm align-middle mb-0">
      <thead><tr><th>Producto</th><th>Cantidad</th><th>Precio</th><th>Subtotal</th></tr></thead>
      <tbody>
        {% for item in object.items.all %}
          <tr>
            <td>{{ item.producto }}</td>
            <td>{{ item.cantidad }}</td>
            <td>${{ item.precio_unitario }}</td>
            <td class="fw-semibold">${{ item.subtotal }}</td>
          </tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr><th colspan="3" class="text-end">Total</th><th>${{ object.total }}</th></tr>
      </tfoot>
    </table>
  </div>
</div>
{% endblock %}
